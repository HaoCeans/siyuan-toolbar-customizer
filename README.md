# ✨ 核心功能亮点

- ➕ **自定义按钮**：在工具栏添加快捷按钮，支持5种功能类型
- 📂 **扩展工具栏**：手机端支持多层扩展，智能溢出检测，自动收纳多余按钮
- 📱 **手机端置底**：工具栏可固定在底部，方便单手操作
- ⚙️ **思源内置功能**：一键触发思源笔记原生功能，如设置、搜索、文件树等
- 📝 **模板插入**：一键插入时间、日期等预设文本
- ⌨️ **快捷键模拟**：执行常用快捷键，如打开日记、全局搜索
- 🖱️ **点击自动化**：模拟多步点击操作，实现复杂功能
- 🔧 **鲸鱼定制工具**：打开指定文档、数据库悬浮弹窗、日记底部等高级功能
- ⚖️ **双端独立配置**：电脑端和手机端分别设置

---

# 📚 功能文档与教程

| 链接 | 说明 |
|------|------|
| [V3.0.0《手机端强化插件》扩展工具栏](https://ld246.com/article/1769539683129) | 功能介绍 |
| [V2.0.0《思源手机端增强》简化重构：小白易用](https://ld246.com/article/1768938149464) | 重构思路 / 新手向说明 |
| [V1.0.0《思源手机端增强插件》手机端自动化！简化操作](https://ld246.com/article/1768670747491) | 开发心得+教学视频+更新说明图 |
| [README_BUILTIN_IDS.md](https://github.com/HaoCeans/siyuan-toolbar-customizer/blob/main/README_BUILTIN_IDS.md) | 思源常用功能ID 速查表 |
| [README_CLICK_SEQUENCE.md](https://github.com/HaoCeans/siyuan-toolbar-customizer/blob/main/README_CLICK_SEQUENCE.md) | 模拟点击序列使用说明 |

---

<details>
  <summary style="font-size: 24px; font-weight: 600; padding: 6px 0; cursor: pointer;">
    🧩 功能特性
  </summary>

### 电脑端
| 功能 | 说明 |
|------|------|
| **自定义按钮** | 在顶部工具栏添加快捷按钮 |
| **5种功能类型** | 思源内置、模板插入、快捷键、点击序列、鲸鱼定制工具 |
| **图标自定义** | 支持思源图标、Lucide 图标、Emoji |
| **按钮样式** | 可调图标大小、宽度、边距 |

### 手机端
| 功能 | 说明 |
|------|------|
| **扩展工具栏** | 支持多层扩展，智能溢出检测，自动收纳多余按钮 |
| **工具栏置底** | 固定在屏幕底部，方便单手操作 |
| **输入法适配** | 键盘弹出时自动上移 |
| **外观定制** | 背景颜色、透明度可调 |
| **独立配置** | 与电脑端分别设置 |

### 通用
| 功能 | 说明 |
|------|------|
| **隐藏内置按钮** | 隐藏不常用的思源原生按钮 |
| **按钮拖拽排序** | 长按拖动调整顺序 |
| **按钮开关** | 可临时禁用某个按钮 |
| **双端独立配置** | 电脑端和手机端互不影响 |

</details>

---

<details>
  <summary style="font-size: 24px; font-weight: 600; padding: 6px 0; cursor: pointer;">
    📖 使用指南
  </summary>

### 一、添加自定义按钮

**路径**：设置 → 插件 → 思源手机端增强

| 设置项 | 说明 |
|--------|------|
| **电脑端配置** | 电脑端工具栏按钮 |
| **手机端配置** | 手机端工具栏按钮 |

点击「添加新按钮」，可选择 4 种功能类型：

#### ① 思源内置功能【简单】
点击「选择」按钮，从列表中选择思源内置功能（如设置、搜索、文件树等）

#### ② 手写模板插入【简单】
插入预设文本，支持变量：

| 变量 | 输出示例 |
|------|----------|
| `{{date}}` | 2026-01-21 |
| `{{time}}` | 14:30:45 |
| `{{datetime}}` | 2026-01-21 14:30:45 |
| `{{year}}` / `{{month}}` / `{{day}}` | 2026 / 01 / 21 |
| `{{hour}}` / `{{minute}}` / `{{second}}` | 14 / 30 / 45 |
| `{{week}}` | 星期二 |

**示例**：插入 `{{year}}年{{month}}月{{day}}日 {{hour}}:{{minute}}` → `2026年01月21日 14:30`

#### ③ 电脑端快捷键【简单】
模拟键盘快捷键，如 `Alt+5`（打开日记）、`Ctrl+P`（全局搜索）

#### ④ 自动化模拟点击【难】
按顺序自动点击多个元素，实现复杂操作

**常用预设**（点击「选择」按钮快速填入）：
- **电脑端**：
  - 打开插件设置：`barPlugins → text:思源手机端增强`
  - 打开伺服浏览器：`barWorkspace → config → → text:关于 → text:打开浏览器`
- **手机端**：
  - 打开插件设置：`toolbarMore → menuPlugin → text:思源手机端增强`
  - 打开伺服浏览器：`toolbarMore → menuAbout`

**选择器语法**：
- 简单 ID：`barSettings`
- CSS 选择器：`#barSettings`
- 文本匹配：`text:复制块引用`

### 二、移动端工具栏设置

将工具栏固定到屏幕底部，方便单手操作。

| 设置项 | 说明 |
|--------|------|
| **工具栏置底** | 开启后工具栏固定在底部 |
| **工具栏背景颜色** | 设置背景色（仅置底时可用） |
| **工具栏透明度** | 调整透明度 0–100%（仅置底时可用） |
| **输入法偏移** | 键盘打开时工具栏上移距离（如 `300px`） |
| **隐藏思源内置按钮** | 隐藏只读模式按钮、隐藏文档按钮|

### 三、常见问题

**Q: 按钮没有显示？**
A: 刷新页面或重启思源笔记

**Q: 点击序列不工作？**
A: 检查选择器是否正确，尝试使用 `text:xxx` 文本匹配

**Q: 手机端工具栏遮挡输入框？**
A: 调整「输入法偏移」数值

</details>

---
# 📌 更新说明

### v3.1.0 — 鲸鱼定制工具箱增强版本

> 🐋 **《鲸鱼定制工具箱》功能详解**：为满足用户个性化需求，我们新增了鲸鱼定制工具箱，包含高级定制功能

#### 🧰 《鲸鱼定制工具箱》说明

##### 1. 功能说明：

   1. 所有作者、个人的定制化需求，均会加入到工具箱。
   2. 核心功能：开箱即用！除基础配置外，无需折腾！
   3. 本插件的免费功能，已经占据99%，如果您仍然需要单独定制功能，请私聊作者，为您私人定制！完成后，按钮将加入工具箱。

##### 2. 激活码获取：

   1. 如果您觉得这个插件好用，不妨支持一下作者，任意金额的打赏，都可以进群私聊群主获得激活码。
   2. 如果您是学生，可进群私聊群主，简单发一下能证明学生的信息，我会免费给您激活码。
   3. 如果您只是想进群交流、体验或观望，也欢迎进群沟通，我会不定期随缘赠送激活码
   4. 后续，随着《鲸鱼定制工具箱》功能大幅增加，是否更改激活码获取规则？视情况而定。

#### ✨ 新增

- 新增全局配置批量应用开关
- 新增"鲸鱼定制工具箱"中"打开指定ID块"功能
- 新增"叶归LiefLog适配"功能，深度适配叶归
- 新增"电脑端检查更新"功能

#### 🛠 修复

- 修复全局按钮配置与单独按钮配置冲突问题
- 修复电脑端工具栏点击效果不会消失，一直保持"被按下"的视觉状态问题
- 修复了电脑端工具栏，鼠标悬停按钮时的效果问题
- 修复"鲸鱼定制工具箱"中"打开指定ID块"功能无法使用问题
- 修复更新提示弹窗，点击弹窗外部区域关闭的问题

<details>
  <summary style="font-size: 18px; font-weight: 600; padding: 6px 0; cursor: pointer;">
    ⬇️ 查看历史版本
  </summary>

### v3.0.0 — 重大重构版本

> ⚠️ **声明**：由于本版本进行了大量代码重构，不排除存在未知 Bug，欢迎进群反馈（QQ：1018010924）

#### ✨ 新增

**更新一：扩展工具栏**

*顶部扩展工具栏*
- 支持多层扩展工具栏弹出（1-5层可配置）
- 点击「⋯」按钮在底部工具栏上方弹出扩展工具栏
- 再次点击关闭扩展工具栏

*底部扩展工具栏*
- 溢出自动检测：根据底部工具栏动态宽度，自动计算并溢出超宽按钮
- 智能宽度计算：按钮宽度 = minWidth + padding + marginRight
- 自动识别不同手机屏幕宽度，适配各种设备

*按钮层级与排序*
- 底部工具栏（第0层）：可见按钮，升序排序（0在最右）
- 扩展工具栏（第1、2...层）：溢出按钮，降序排序（视觉从右到左）
- 扩展工具栏按钮固定 sort=0，始终在第一位，不可删除但可开关

**更新二：工具栏背景颜色自适应**
- 明亮模式与黑暗模式独立配置
- 背景颜色同时应用到扩展工具栏
- 透明度设置同步应用于所有工具栏

**更新三：全局按钮配置**
- 图标大小：批量设置所有按钮默认值
- 按钮宽度：批量设置所有按钮默认值
- 右边距：批量设置所有按钮默认值
- 右上角提示：一键开启/关闭所有按钮提示

**更新四：顶部、底部工具栏配置**
- 工具栏置底开关（手机端）
- 工具栏高度调节（桌面端）
- 输入法偏移距离（手机端）
- 扩展按钮距离顶部/底部距离

**更新五：鲸鱼定制工具**
- 标签紫色加粗显示，便于快速识别
- 支持打开指定ID文档
- 数据库悬浮弹窗（支持手机端）
- 日记底部功能（可配置等待时间）

#### 🔧 技术改进
- **深度适配思源源码**：通过阅读思源笔记源码，直接优化思源本体工具栏逻辑
- **更加贴合思源本体**：更改后的工具栏与思源原生样式和交互无缝融合
- **当前版本兼容**：在目前思源版本中经过充分测试，插件正常工作
- **修复大量遗留 Bug**：优化代码质量，提升稳定性

#### 🛠 修复

*交互优化*
| 位置 | 按钮类型 | 输入法行为 |
|------|----------|------------|
| 主工具栏 | 思源内置功能 | 关闭 |
| 主工具栏 | 其他类型 | 不关闭 |
| 扩展工具栏按钮（⋯） | - | 不关闭 |
| 扩展工具栏内 | 思源内置功能 | 关闭 |
| 扩展工具栏内 | 其他类型 | 不关闭 |

- 完全恢复思源原始状态功能生效，开启后隐藏所有自定义按钮

#### 📝 文档更新
- 新增名词统一表（底部工具栏、锁定按钮、扩展工具栏按钮、扩展工具栏、可见按钮、溢出按钮）
- 常用ID链接移至「自动化模拟点击」说明中

#### 🚀 代码重构
- 拆分 UI / Settings / Components 模块
- 主类职责单一化
- 提高可维护性、可扩展性、可读性
- 为后续功能扩展和测试奠定结构基础

<details>
  <summary style="font-size: 18px; font-weight: 600; padding: 6px 0; cursor: pointer;">
    ⬇️ 查看历史版本
  </summary>

### v2.5.1

#### ✨ 新增
- 桌面端，增加自行调节工具栏高度功能
- 桌面端，增加完全恢复思源原始状态功能（禁用所有自定义按钮和样式修改）
- 手机端，增加工具栏背景颜色配置（明亮模式 + 黑暗模式独立设置）

### v2.4.7

#### 🛠 修复
- 修复 iOS 手机端底部白条问题（home indicator 遮挡工具栏）

### v2.4.5

#### 🛠 修复
- 手机端设置工具栏高度设置问题
- 鸿蒙手机端，无法修改工具栏颜色的问题
- 鸿蒙手机端，在不打开底部工具栏时，底部仍然有白色占位的背景条问题
- iOS 手机端，工具栏层级设置非常高，底部工具栏仍然被遮挡问题
- 修复部分遗留 bug（内存泄漏、性能优化）

#### ✨ 新增
- 新增全局工具栏配置
- 增加颜色选择按钮：选择颜色 or 跟随主题色变化
- 第一次安装，手机端、电脑端默认加 7 个按钮
- 思源默认按钮：更多、打开菜单、锁住文档；替换为更好点的按钮

### v2.0.0（重构、简化操作）

#### ✨ 新增

**增强兼容性**
| 平台                              | 是否支持    |
| ----------------------------------- | ------------- |
| 鸿蒙系统                          | ✅ 正常支持 |
| Android                           | ✅ 支持     |
| iOS                               | ✅ 支持     |
| 桌面端（Windows / macOS / Linux） | ✅ 支持     |
| WebView / 内嵌环境                | ✅ 稳定     |

**简化操作**
- 预设 **23 个**手机端思源内置按钮，供用户快速选择
- 支持电脑端配置手机端按钮

**新增功能**
- 电脑端打开手机伺服浏览器预览
- 100 种按钮图标选择
- 按钮开关功能（可临时禁用按钮）
- 手写模板变量增强：小时、分钟、秒
- 首次安装欢迎提示
- 自动化模拟点击预设：打开插件设置、打开伺服浏览器

#### 🛠 修复
- 鸿蒙系统适配问题

### v1.1.2
- 增加执行快捷键按钮
- 栏内按钮均匀分布设置

### v1.0.6
- 修复工具栏按钮全部删除后会重新出现的问题

### v1.0.5
- 修复插件设置中"保存 / 取消"按钮位置异常
- 修复工具栏按钮无法正常删除
- 修复底部工具栏遮挡设置界面
- 新增插入模板内容功能，支持自动填充时间、日期
- 手机端新增工具栏高度设置
- 手机端新增工具栏层级（z-index）设置

</details>

---

# ❓问题反馈Q群

感谢您的支持与反馈，这将鼓励作者持续开发

<div align="center">
  <img src="https://raw.githubusercontent.com/HaoCeans/siyuan-toolbar-customizer/main/preview2.png" alt="预览图" width="300">
</div>

# 🧧 打赏支持

感谢您的支持与反馈，这将鼓励作者持续开发

<div align="center">
  <img src="https://raw.githubusercontent.com/HaoCeans/siyuan-toolbar-customizer/main/payment2.png" alt="打赏二维码" width="300">
</div>

<div align="center">
  <img src="https://raw.githubusercontent.com/HaoCeans/siyuan-toolbar-customizer/main/payment1.png" alt="打赏二维码" width="300">
</div>

---

<details>
  <summary style="font-size: 24px; font-weight: 600; padding: 6px 0; cursor: pointer;">
    📦 插件说明总览
  </summary>

| 模块 | 子项 | 内容 |
|------|------|------|
| 安装 | 从插件集市安装 | 1. 打开思源笔记<br>2. 设置 → 集市 → 插件<br>3. 搜索 **思源手机端增强**<br>4. 点击安装 |
| 安装 | 手动安装 | 1. 从 [GitHub Releases](https://github.com/siyuan-note/siyuan-toolbar-customizer/releases) 下载最新版本<br>2. 解压 zip 文件<br>3. 复制到 `{工作空间}/data/plugins/`<br>4. 重启思源笔记<br>5. 设置 → 集市 → 已下载 中启用插件 |
| 开发 | 从源码构建 | `git clone https://github.com/siyuan-note/siyuan-toolbar-customizer.git`<br>`cd siyuan-toolbar-customizer`<br>`npm install`<br>`npm run dev`<br>`npm run build` |
| 开发 | 项目结构 | `src/index.ts` 主逻辑<br>`src/toolbarManager.ts` 工具栏管理<br>`src/App.vue` 设置界面<br>`src/index.scss` 样式<br>`public/` 静态资源<br>`plugin.json` 插件元数据 |
| 文档 | 更新日志 | 查看版本历史：<br>[CHANGELOG.md](https://github.com/HaoCeans/siyuan-toolbar-customizer/blob/main/CHANGELOG.md) |
| 协议 | 许可证 | MIT License（详见 LICENSE 文件） |
| 社区 | 贡献 | 欢迎提交 Issue 与 Pull Request |
| 支持 | 问题反馈 | GitHub Issues：<br>👉 https://github.com/siyuan-note/siyuan-toolbar-customizer/issues |
| 支持 | 社区讨论 | 思源社区：<br>👉 https://ld246.com |
| 致谢 | 基础 | 基于 [思源笔记插件系统](https://github.com/siyuan-note/siyuan) |
| 致谢 | 图标 | 来自 [Lucide](https://lucide.dev/) |
| 致谢 | 模板 | 基于 [Vite + Vue 插件模板](https://github.com/siyuan-note/siyuan-toolbar-customizer) |

</details>
